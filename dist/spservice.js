!function(){"use strict";angular.module("SharePointService",[]).service("SPService",["$http",function(t){this.uploadAttachment=function(e,a,i,s){return t({method:"POST",url:SP_GLOBAL.WEB_URL+"/_api/web/lists/getbytitle('"+e+"')/items("+a+")/AttachmentFiles/add(FileName='"+i+"')",headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","X-RequestDigest":SP_GLOBAL.REQUEST_DIGEST},data:s})},this.deleteAttachment=function(e,a,i){return t({method:"DELETE",url:SP_GLOBAL.WEB_URL+"/_api/web/lists/getbytitle('"+e+"')/items("+a+")/AttachmentFiles/add(FileName='"+i+"')",headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","X-RequestDigest":SP_GLOBAL.REQUEST_DIGEST}})},this.getAttachments=function(e,a){return t({method:"GET",url:SP_GLOBAL.WEB_URL+"/_api/web/lists/getbytitle('"+e+"')/items("+a+")/AttachmentFiles",headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","X-RequestDigest":SP_GLOBAL.REQUEST_DIGEST}})},this.addListItem=function(e,a){e.__metadata={},e.__metadata.type="SP.Data."+a+"ListItem";var i={method:"POST",url:SP_GLOBAL.WEB_URL+"/_api/web/lists/getbytitle('"+a+"')/items",headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","X-RequestDigest":SP_GLOBAL.REQUEST_DIGEST},data:JSON.stringify(e)};return t(i)},this.updateListItem=function(e,a){return e.__metadata={},e.__metadata.type=a.type,t({method:"POST",url:SP_GLOBAL.WEB_URL+"/_api/"+a.id,headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","X-RequestDigest":SP_GLOBAL.REQUEST_DIGEST,"X-HTTP-Method":"MERGE","If-Match":a.etag},data:JSON.stringify(e)})},this.getUserById=function(e){return t.get(SP_GLOBAL.WEB_URL+"/_api/web/getUserById("+e+")")},this.me=function(){return t.get(SP_GLOBAL.WEB_URL+"/_api/SP.UserProfiles.PeopleManager/GetMyProperties")},this.getGroupUsers=function(e){return t.get(SP_GLOBAL.WEB_URL+"/_api/web/sitegroups/getbyname('"+e+"')/users")},this.getListItems=function(e,a,s,n,o){var r="";if(a&&a instanceof Array){for(i=0;i<a.length;i++)r+=a[i]+",";r=r.slice(0,-1),r&&(r="$select="+r+"&")}var c="";if(s&&s instanceof Object){for(var p in s)for(var _ in s[p])c+=p+" "+_+" '"+s[p][_]+"' and ";c=c.substring(0,c.length-4),c&&(c="$filter="+c+"&")}var d="";n&&n instanceof Array&&(d="$orderby="+n[0],d+=d[1]?" "+d[1]:" asc",d&&(d+="&"));var L="";return o&&(L="$top="+o),t.get(SP_GLOBAL.WEB_URL+"/_api/web/lists/getByTitle('"+e+"')/items?"+r+c+L)}}]).constant("SP_GLOBAL",{WEB_URL:"XXXXX",REQUEST_DIGEST:document.getElementById("__REQUESTDIGEST").value})}();