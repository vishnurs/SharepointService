!function(){"use strict";angular.module("SharePointService",[]).service("SPService",["$http",function(t){this.addListItem=function(e,a){e.__metadata={},e.__metadata.type="SP.Data."+a+"ListItem";var i={method:"POST",url:SP_GLOBAL.WEB_URL+"/_api/web/lists/getbytitle('"+a+"')/items",headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","X-RequestDigest":SP_GLOBAL.REQUEST_DIGEST},data:JSON.stringify(e)};return t(i)},this.updateListItem=function(e,a){return e.__metadata={},e.__metadata.type=a.type,t({method:"POST",url:SP_GLOBAL.WEB_URL+"/_api/"+a.id,headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","X-RequestDigest":SP_GLOBAL.REQUEST_DIGEST,"X-HTTP-Method":"MERGE","If-Match":a.etag},data:JSON.stringify(e)})},this.getUserById=function(e){return t.get(SP_GLOBAL.WEB_URL+"/_api/web/getUserById("+e+")")},this.me=function(){return t.get(SP_GLOBAL.WEB_URL+"/_api/SP.UserProfiles.PeopleManager/GetMyProperties")},this.getGroupUsers=function(e){return t.get(SP_GLOBAL.WEB_URL+"/_api/web/sitegroups/getbyname('"+e+"')/users")},this.getListItems=function(e,a,r,n,s){var o="";if(a&&a instanceof Array){for(i=0;i<a.length;i++)o+=a[i]+",";o=o.slice(0,-1),o&&(o="$select="+o+"&")}var _="";if(r&&r instanceof Object){for(var c in r)for(var L in r[c])_+=c+" "+L+" '"+r[c][L]+"' and ";_=_.substring(0,_.length-4),_&&(_="$filter="+_+"&")}var p="";n&&n instanceof Array&&(p="$orderby="+n[0],p+=p[1]?" "+p[1]:" asc",p&&(p+="&"));var u="";return s&&(u="$top="+s),t.get(SP_GLOBAL.WEB_URL+"/_api/web/lists/getByTitle('"+e+"')/items?"+o+_+u)}}]).constant("SP_GLOBAL",{WEB_URL:"XXXXX",REQUEST_DIGEST:document.getElementById("__REQUESTDIGEST").value})}();